{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="header flex-line">
        <div>
            <h1>My Projects</h1>
        </div>
        <div>
            <a href="{% url 'projects:project_create' %}" class="btn btn-circle btn-primary">
                +
            </a>
        </div>
    </div>
    
    <div class="filters">
        <a href="?status=all" class="filter {% if status == 'all' %}active{% endif %}">
            All
        </a>
        <a href="?status=active" class="filter {% if status == 'active' %}active{% endif %}">
            Active
        </a>
        <a href="?status=completed" class="filter {% if status == 'completed' %}active{% endif %}">
            Completed
        </a>
        <a href="?status=archived" class="filter {% if status == 'archived' %}active{% endif %}">
            Archived
        </a>
    </div>
    
    <!-- Project Grid -->
    <div class="project-grid">
        {% for project in projects %}
        <div class="project-card">

            <!-- Title + Status -->
            <div class="card-header">
                <a href="{% url 'projects:project_detail' project.id %}"><h3>{{ project.name }}</h3></a>
                
                {% if project.status %}
                    <span class="status-badge status-{{ project.status|lower|slugify }}">
                        {{ project.get_status_display }}
                    </span>
                {% endif %}
            </div>

            <!-- Description -->
            {% if project.description %}
            <p class="description">{{ project.description|truncatechars:100 }}</p>
            {% endif %}

            <div class="spacer"></div>

            {% with completion=project.get_completion_percentage %}
                <!-- Progress Bar -->
                <div class="progress-bar">
                    <div class="progress-fill" 
                        style="width: {{ completion }}">
                    </div>
                </div>
                <!-- Actions -->
                <div class="actions">
                    <div class="progress-text">
                        {{ completion }} complete
                    </div>
                    <div>
                        <a href="{% url 'projects:project_setup' project.id %}" class="">‚öôÔ∏è</a>
        
                        <form action="{% url 'projects:project_delete' project.id %}" 
                              method="post" class="inline-form"
                              onsubmit="return confirm('Delete this project?');">
                            {% csrf_token %}
                            <button type="submit" class="">
                                üóëÔ∏è
                            </button>
                        </form>
                    </div>
                </div>
            {% endwith %}

            

        </div>

        {% empty %}
        <div class="empty-state">
            <p>No projects yet. Create your first one!</p>
        </div>
        {% endfor %}
    </div>

</div>


{% endblock %}