{% load static %}

<div style="margin-bottom: 10px;">
    <button onclick="window.saveDiagramToDB({{ project_id }})"
            style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
        ðŸ’¾ Sauvegarder le diagramme
    </button>
    <button onclick="console.log(window.exportDiagramState())"
            style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-left: 10px;">
        ðŸ“‹ Voir JSON dans console
    </button>
</div>

<div id="diagram-container" style="position: relative; width: 100%; height: 600px; border: 1px solid #ccc;">
    {% for box in boxes %}
    <div id="{{ box.id }}" class="diagram-box" 
         style="left: {{ box.x }}px; top: {{ box.y }}px; position: absolute; border: 1px solid black; padding: 10px; background: white;">
        <h3>{{ box.label }}</h3>
        <p>{{ box.description }}</p>
    </div>
    {% endfor %}
</div>
<!--Django creates an invisible div without escapes and still safe -->
{{ arrows|json_script:"arrows-data" }}

{% block extra_js %}
    <script src="{% static 'js/jsplumb.browser-ui.umd.min.js' %}"></script>
    <script src="{% static 'js/diagram.js' %}"></script>
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/jsplumbtoolkit.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/diagram.css' %}">
{% endblock %}